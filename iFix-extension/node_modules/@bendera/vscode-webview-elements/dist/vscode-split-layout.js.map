{"version":3,"file":"vscode-split-layout.js","sourceRoot":"","sources":["../src/vscode-split-layout.ts"],"names":[],"mappings":";;;;;;AAAA,OAAO,EAAC,GAAG,EAAkB,IAAI,EAAiB,MAAM,KAAK,CAAC;AAC9D,OAAO,EAAC,aAAa,EAAE,QAAQ,EAAE,KAAK,EAAC,MAAM,mBAAmB,CAAC;AACjE,OAAO,EAAC,QAAQ,EAAC,MAAM,6BAA6B,CAAC;AACrD,OAAO,EAAC,QAAQ,EAAC,MAAM,6BAA6B,CAAC;AACrD,OAAO,EAAC,UAAU,EAAC,MAAM,uBAAuB,CAAC;AAEjD,MAAM,WAAW,GAAG,CAAC,CAAC;AAGtB,IAAa,iBAAiB,GAA9B,MAAa,iBAAkB,SAAQ,UAAU;IAAjD;;QAEE,UAAK,GAA8B,UAAU,CAAC;QAG9C,oBAAe,GAAG,KAAK,CAAC;QAGxB,eAAU,GAAG,KAAK,CAAC;QAEV,oBAAe,GAAG,CAAC,CAAC;QACpB,qBAAgB,GAAG,CAAC,CAAC;QACrB,gBAAW,GAAG,CAAC,CAAC;QAChB,iBAAY,GAAG,CAAC,CAAC;QACjB,gBAAW,GAAG,CAAC,CAAC;QAChB,eAAU,GAAG,CAAC,CAAC;QACf,kBAAa,GAAG,KAAK,CAAC;QAGvB,WAAM,GAAG,KAAK,CAAC;QAGf,UAAK,GAAG,KAAK,CAAC;QAEd,eAAU,GAAY,IAAI,OAAO,EAAE,CAAC;QACpC,kBAAa,GAAG,CAAC,CAAC;QAkFlB,wBAAmB,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QA6BrD,0BAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAiJnE,CAAC;IA9PC,iBAAiB;QACf,KAAK,CAAC,iBAAiB,EAAE,CAAC;QAE1B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAE/C,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAEO,aAAa;QACnB,MAAM,EAAC,MAAM,EAAE,KAAK,EAAC,GAAG,IAAI,CAAC,UAAU,CAAC;QACxC,MAAM,MAAM,GAAG,IAAI,CAAC,KAAK,KAAK,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC;QAC1D,MAAM,OAAO,GAAG,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC5D,IAAI,GAAG,GAAG,CAAC,CAAC;QACZ,IAAI,UAAU,GAAG,CAAC,CAAC;QAEnB,IAAI,OAAO,EAAE;YACX,UAAU,GAAG,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;SACrC;QAED,IAAI,OAAO,IAAI,OAAO,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;YACjC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,UAAU,CAAC,CAAC;SACrD;aAAM,IAAI,OAAO,IAAI,OAAO,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;YACxC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;SACpC;aAAM;YACL,GAAG,GAAG,MAAM,GAAG,CAAC,CAAC;SAClB;QAED,IAAI,IAAI,CAAC,KAAK,KAAK,UAAU,EAAE;YAC7B,IAAI,CAAC,eAAe,GAAG,MAAM,GAAG,GAAG,CAAC;YACpC,IAAI,CAAC,YAAY,GAAG,GAAG,CAAC;YACxB,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC;SACxB;QAED,IAAI,IAAI,CAAC,KAAK,KAAK,YAAY,EAAE;YAC/B,IAAI,CAAC,gBAAgB,GAAG,MAAM,GAAG,GAAG,CAAC;YACrC,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC;YACvB,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC;SACvB;IACH,CAAC;IAEO,gBAAgB;QACtB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACnB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;IACrB,CAAC;IAEO,eAAe,CAAC,KAAiB;QACvC,IAAI,KAAK,CAAC,OAAO,KAAK,CAAC,EAAE;YACvB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YACpB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;SACnB;IACH,CAAC;IAEO,gBAAgB,CAAC,KAAiB;QACxC,KAAK,CAAC,eAAe,EAAE,CAAC;QACxB,KAAK,CAAC,cAAc,EAAE,CAAC;QAEvB,MAAM,WAAW,GAAG,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;QACzD,MAAM,WAAW,GAAG,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC;QAExD,IAAI,IAAI,CAAC,KAAK,KAAK,UAAU,EAAE;YAC7B,IAAI,CAAC,aAAa,GAAG,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;SACrD;QAED,IAAI,IAAI,CAAC,KAAK,KAAK,YAAY,EAAE;YAC/B,IAAI,CAAC,aAAa,GAAG,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC;SACpD;QAED,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC/C,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;QAE1B,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;QAC7D,MAAM,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC;IACnE,CAAC;IAEO,cAAc;QACpB,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;QAC3B,MAAM,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;QAChE,MAAM,CAAC,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC;IACtE,CAAC;IAIO,gBAAgB,CAAC,KAAiB;QACxC,MAAM,EAAC,OAAO,EAAE,OAAO,EAAC,GAAG,KAAK,CAAC;QACjC,MAAM,EAAC,IAAI,EAAE,GAAG,EAAE,MAAM,EAAE,KAAK,EAAC,GAAG,IAAI,CAAC,UAAU,CAAC;QAEnD,IAAI,IAAI,CAAC,KAAK,KAAK,UAAU,EAAE;YAC7B,MAAM,WAAW,GAAG,OAAO,GAAG,IAAI,CAAC;YAEnC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CACzB,CAAC,EACD,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,EAAE,KAAK,CAAC,CAClD,CAAC;YACF,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC;YAC7D,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC;SACtC;QAED,IAAI,IAAI,CAAC,KAAK,KAAK,YAAY,EAAE;YAC/B,MAAM,WAAW,GAAG,OAAO,GAAG,GAAG,CAAC;YAElC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,GAAG,CACxB,CAAC,EACD,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,EAAE,MAAM,CAAC,CACnD,CAAC;YACF,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC;YAC9D,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC;SACpC;IACH,CAAC;IAIO,eAAe;QACrB,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YACzB,OAAO;SACR;QAED,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAED,MAAM,KAAK,MAAM;QACf,OAAO;YACL,KAAK,CAAC,MAAM;YACZ,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OAmEF;SACF,CAAC;IACJ,CAAC;IAED,MAAM;QACJ,MAAM,eAAe,GAAG,QAAQ,CAAC;YAC/B,MAAM,EAAE,GAAG,IAAI,CAAC,gBAAgB,IAAI;YACpC,KAAK,EAAE,GAAG,IAAI,CAAC,eAAe,IAAI;SACnC,CAAC,CAAC;QAEH,MAAM,aAAa,GAAG,QAAQ,CAAC;YAC7B,IAAI,EAAE,GAAG,IAAI,CAAC,YAAY,IAAI;YAC9B,GAAG,EAAE,GAAG,IAAI,CAAC,WAAW,IAAI;SAC7B,CAAC,CAAC;QAEH,MAAM,mBAAmB,GAA6B;YACpD,IAAI,EAAE,GAAG,IAAI,CAAC,WAAW,IAAI;YAC7B,GAAG,EAAE,GAAG,IAAI,CAAC,UAAU,IAAI;SAC5B,CAAC;QAEF,IAAI,IAAI,CAAC,KAAK,KAAK,UAAU,EAAE;YAC7B,mBAAmB,CAAC,UAAU,GAAG,GAAG,CAAC,GAAG,WAAW,GAAG,CAAC,IAAI,CAAC;YAC5D,mBAAmB,CAAC,KAAK,GAAG,GAAG,WAAW,IAAI,CAAC;SAChD;QAED,IAAI,IAAI,CAAC,KAAK,KAAK,YAAY,EAAE;YAC/B,mBAAmB,CAAC,MAAM,GAAG,GAAG,WAAW,IAAI,CAAC;YAChD,mBAAmB,CAAC,SAAS,GAAG,GAAG,CAAC,GAAG,WAAW,GAAG,CAAC,IAAI,CAAC;SAC5D;QAED,MAAM,YAAY,GAAG,QAAQ,CAAC,mBAAmB,CAAC,CAAC;QAEnD,MAAM,oBAAoB,GAAG,QAAQ,CAAC;YACpC,gBAAgB,EAAE,IAAI;YACtB,MAAM,EAAE,IAAI,CAAC,aAAa;YAC1B,gBAAgB,EAAE,IAAI,CAAC,KAAK,KAAK,UAAU;YAC3C,kBAAkB,EAAE,IAAI,CAAC,KAAK,KAAK,YAAY;SAChD,CAAC,CAAC;QAEH,MAAM,aAAa,GAAG,QAAQ,CAAC;YAC7B,MAAM,EAAE,IAAI;YACZ,KAAK,EAAE,IAAI,CAAC,MAAM;YAClB,IAAI,EAAE,IAAI,CAAC,KAAK;YAChB,gBAAgB,EAAE,IAAI,CAAC,KAAK,KAAK,UAAU;YAC3C,kBAAkB,EAAE,IAAI,CAAC,KAAK,KAAK,YAAY;SAChD,CAAC,CAAC;QAEH,OAAO,IAAI,CAAA;kCACmB,eAAe;;;gCAGjB,aAAa;;;oBAGzB,oBAAoB;;iBAEvB,aAAa;iBACb,YAAY;sBACP,IAAI,CAAC,gBAAgB;qBACtB,IAAI,CAAC,eAAe;sBACnB,IAAI,CAAC,gBAAgB;qBACtB,IAAI,CAAC,eAAe;;KAEpC,CAAC;IACJ,CAAC;CACF,CAAA;AAvRC;IADC,QAAQ,EAAE;gDACmC;AAG9C;IADC,QAAQ,CAAC,EAAC,IAAI,EAAE,OAAO,EAAC,CAAC;0DACF;AAGxB;IADC,QAAQ,EAAE;qDACQ;AAEV;IAAR,KAAK,EAAE;0DAAqB;AACpB;IAAR,KAAK,EAAE;2DAAsB;AACrB;IAAR,KAAK,EAAE;sDAAiB;AAChB;IAAR,KAAK,EAAE;uDAAkB;AACjB;IAAR,KAAK,EAAE;sDAAiB;AAChB;IAAR,KAAK,EAAE;qDAAgB;AACf;IAAR,KAAK,EAAE;wDAAuB;AAG/B;IADC,KAAK,EAAE;iDACe;AAGvB;IADC,KAAK,EAAE;gDACc;AAtBX,iBAAiB;IAD7B,aAAa,CAAC,qBAAqB,CAAC;GACxB,iBAAiB,CAyR7B;SAzRY,iBAAiB","sourcesContent":["import {css, CSSResultGroup, html, TemplateResult} from 'lit';\r\nimport {customElement, property, state} from 'lit/decorators.js';\r\nimport {classMap} from 'lit/directives/class-map.js';\r\nimport {styleMap} from 'lit/directives/style-map.js';\r\nimport {VscElement} from './includes/VscElement';\r\n\r\nconst HANDLE_SIZE = 4;\r\n\r\n@customElement('vscode-split-layout')\r\nexport class VscodeSplitLayout extends VscElement {\r\n  @property()\r\n  split: 'horizontal' | 'vertical' = 'vertical';\r\n\r\n  @property({type: Boolean})\r\n  resetOnDblClick = false;\r\n\r\n  @property()\r\n  initialPos = '50%';\r\n\r\n  @state() _startPaneRight = 0;\r\n  @state() _startPaneBottom = 0;\r\n  @state() _endPaneTop = 0;\r\n  @state() _endPaneLeft = 0;\r\n  @state() _handleLeft = 0;\r\n  @state() _handleTop = 0;\r\n  @state() _isDragActive = false;\r\n\r\n  @state()\r\n  private _hover = false;\r\n\r\n  @state()\r\n  private _hide = false;\r\n\r\n  private _boundRect: DOMRect = new DOMRect();\r\n  private _handleOffset = 0;\r\n\r\n  connectedCallback(): void {\r\n    super.connectedCallback();\r\n\r\n    this._boundRect = this.getBoundingClientRect();\r\n\r\n    this._initPosition();\r\n  }\r\n\r\n  private _initPosition() {\r\n    const {height, width} = this._boundRect;\r\n    const maxPos = this.split === 'vertical' ? width : height;\r\n    const matches = /(^[0-9.]+)(%{0,1})$/.exec(this.initialPos);\r\n    let pos = 0;\r\n    let numericVal = 0;\r\n\r\n    if (matches) {\r\n      numericVal = parseFloat(matches[1]);\r\n    }\r\n\r\n    if (matches && matches[2] === '%') {\r\n      pos = Math.min(maxPos, (maxPos / 100) * numericVal);\r\n    } else if (matches && matches[2] !== '%') {\r\n      pos = Math.min(numericVal, maxPos);\r\n    } else {\r\n      pos = maxPos / 2;\r\n    }\r\n\r\n    if (this.split === 'vertical') {\r\n      this._startPaneRight = maxPos - pos;\r\n      this._endPaneLeft = pos;\r\n      this._handleLeft = pos;\r\n    }\r\n\r\n    if (this.split === 'horizontal') {\r\n      this._startPaneBottom = maxPos - pos;\r\n      this._endPaneTop = pos;\r\n      this._handleTop = pos;\r\n    }\r\n  }\r\n\r\n  private _handleMouseOver() {\r\n    this._hover = true;\r\n    this._hide = false;\r\n  }\r\n\r\n  private _handleMouseOut(event: MouseEvent) {\r\n    if (event.buttons !== 1) {\r\n      this._hover = false;\r\n      this._hide = true;\r\n    }\r\n  }\r\n\r\n  private _handleMouseDown(event: MouseEvent) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n\r\n    const mouseXLocal = event.clientX - this._boundRect.left;\r\n    const mouseYLocal = event.clientY - this._boundRect.top;\r\n\r\n    if (this.split === 'vertical') {\r\n      this._handleOffset = mouseXLocal - this._handleLeft;\r\n    }\r\n\r\n    if (this.split === 'horizontal') {\r\n      this._handleOffset = mouseYLocal - this._handleTop;\r\n    }\r\n\r\n    this._boundRect = this.getBoundingClientRect();\r\n    this._isDragActive = true;\r\n\r\n    window.addEventListener('mouseup', this._handleMouseUpBound);\r\n    window.addEventListener('mousemove', this._handleMouseMoveBound);\r\n  }\r\n\r\n  private _handleMouseUp() {\r\n    this._isDragActive = false;\r\n    window.removeEventListener('mouseup', this._handleMouseUpBound);\r\n    window.removeEventListener('mousemove', this._handleMouseMoveBound);\r\n  }\r\n\r\n  private _handleMouseUpBound = this._handleMouseUp.bind(this);\r\n\r\n  private _handleMouseMove(event: MouseEvent) {\r\n    const {clientX, clientY} = event;\r\n    const {left, top, height, width} = this._boundRect;\r\n\r\n    if (this.split === 'vertical') {\r\n      const mouseXLocal = clientX - left;\r\n\r\n      this._handleLeft = Math.max(\r\n        0,\r\n        Math.min(mouseXLocal - this._handleOffset, width)\r\n      );\r\n      this._startPaneRight = Math.max(0, width - this._handleLeft);\r\n      this._endPaneLeft = this._handleLeft;\r\n    }\r\n\r\n    if (this.split === 'horizontal') {\r\n      const mouseYLocal = clientY - top;\r\n\r\n      this._handleTop = Math.max(\r\n        0,\r\n        Math.min(mouseYLocal - this._handleOffset, height)\r\n      );\r\n      this._startPaneBottom = Math.max(0, height - this._handleTop);\r\n      this._endPaneTop = this._handleTop;\r\n    }\r\n  }\r\n\r\n  private _handleMouseMoveBound = this._handleMouseMove.bind(this);\r\n\r\n  private _handleDblClick() {\r\n    if (!this.resetOnDblClick) {\r\n      return;\r\n    }\r\n\r\n    this._initPosition();\r\n  }\r\n\r\n  static get styles(): CSSResultGroup {\r\n    return [\r\n      super.styles,\r\n      css`\r\n        :host {\r\n          display: block;\r\n          overflow: hidden;\r\n          position: relative;\r\n        }\r\n\r\n        .start {\r\n          left: 0;\r\n          top: 0;\r\n          overflow: hidden;\r\n          position: absolute;\r\n        }\r\n\r\n        .end {\r\n          bottom: 0;\r\n          overflow: hidden;\r\n          position: absolute;\r\n          right: 0;\r\n        }\r\n\r\n        .handle-overlay {\r\n          display: none;\r\n          height: 100%;\r\n          left: 0;\r\n          position: absolute;\r\n          top: 0;\r\n          width: 100%;\r\n          z-index: 1;\r\n        }\r\n\r\n        .handle-overlay.active {\r\n          display: block;\r\n        }\r\n\r\n        .handle-overlay.split-vertical {\r\n          cursor: ew-resize;\r\n        }\r\n\r\n        .handle-overlay.split-horizontal {\r\n          cursor: ns-resize;\r\n        }\r\n\r\n        .handle {\r\n          position: absolute;\r\n          z-index: 2;\r\n        }\r\n\r\n        .handle.hover {\r\n          background-color: var(--vscode-sash-hoverBorder);\r\n          transition: background-color 100ms linear 300ms;\r\n        }\r\n\r\n        .handle.hide {\r\n          background-color: transparent;\r\n          transition: background-color 100ms linear;\r\n        }\r\n\r\n        .handle.split-vertical {\r\n          cursor: ew-resize;\r\n          height: 100%;\r\n        }\r\n\r\n        .handle.split-horizontal {\r\n          cursor: ns-resize;\r\n          width: 100%;\r\n        }\r\n      `,\r\n    ];\r\n  }\r\n\r\n  render(): TemplateResult {\r\n    const startPaneStyles = styleMap({\r\n      bottom: `${this._startPaneBottom}px`,\r\n      right: `${this._startPaneRight}px`,\r\n    });\r\n\r\n    const endPaneStyles = styleMap({\r\n      left: `${this._endPaneLeft}px`,\r\n      top: `${this._endPaneTop}px`,\r\n    });\r\n\r\n    const handleStylesPropObj: {[prop: string]: string} = {\r\n      left: `${this._handleLeft}px`,\r\n      top: `${this._handleTop}px`,\r\n    };\r\n\r\n    if (this.split === 'vertical') {\r\n      handleStylesPropObj.marginLeft = `${0 - HANDLE_SIZE / 2}px`;\r\n      handleStylesPropObj.width = `${HANDLE_SIZE}px`;\r\n    }\r\n\r\n    if (this.split === 'horizontal') {\r\n      handleStylesPropObj.height = `${HANDLE_SIZE}px`;\r\n      handleStylesPropObj.marginTop = `${0 - HANDLE_SIZE / 2}px`;\r\n    }\r\n\r\n    const handleStyles = styleMap(handleStylesPropObj);\r\n\r\n    const handleOverlayClasses = classMap({\r\n      'handle-overlay': true,\r\n      active: this._isDragActive,\r\n      'split-vertical': this.split === 'vertical',\r\n      'split-horizontal': this.split === 'horizontal',\r\n    });\r\n\r\n    const handleClasses = classMap({\r\n      handle: true,\r\n      hover: this._hover,\r\n      hide: this._hide,\r\n      'split-vertical': this.split === 'vertical',\r\n      'split-horizontal': this.split === 'horizontal',\r\n    });\r\n\r\n    return html`\r\n      <div class=\"start\" style=\"${startPaneStyles}\">\r\n        <slot name=\"start\"></slot>\r\n      </div>\r\n      <div class=\"end\" style=\"${endPaneStyles}\">\r\n        <slot name=\"end\"></slot>\r\n      </div>\r\n      <div class=\"${handleOverlayClasses}\"></div>\r\n      <div\r\n        class=\"${handleClasses}\"\r\n        style=\"${handleStyles}\"\r\n        @mouseover=\"${this._handleMouseOver}\"\r\n        @mouseout=\"${this._handleMouseOut}\"\r\n        @mousedown=\"${this._handleMouseDown}\"\r\n        @dblclick=\"${this._handleDblClick}\"\r\n      ></div>\r\n    `;\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'vscode-split-layout': VscodeSplitLayout;\r\n  }\r\n}\r\n"]}