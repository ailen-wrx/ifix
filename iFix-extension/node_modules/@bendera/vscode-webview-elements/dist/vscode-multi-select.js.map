{"version":3,"file":"vscode-multi-select.js","sourceRoot":"","sources":["../src/vscode-multi-select.ts"],"names":[],"mappings":"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","sourcesContent":["import {html, TemplateResult} from 'lit';\r\nimport {customElement, property} from 'lit/decorators.js';\r\nimport {classMap} from 'lit/directives/class-map.js';\r\nimport {repeat} from 'lit/directives/repeat.js';\r\nimport {chevronDownIcon} from './includes/vscode-select/template-elements';\r\nimport {VscodeSelectBase} from './includes/vscode-select/vscode-select-base';\r\n\r\n/**\r\n * @attr name - Name which is used as a variable name in the data of the form-container.\r\n */\r\n@customElement('vscode-multi-select')\r\nexport class VscodeMultiSelect extends VscodeSelectBase {\r\n  @property({type: Array})\r\n  set selectedIndexes(val: number[]) {\r\n    this._selectedIndexes = val;\r\n  }\r\n  get selectedIndexes(): number[] {\r\n    return this._selectedIndexes;\r\n  }\r\n\r\n  @property({type: Array})\r\n  set value(val: string[]) {\r\n    this._values = val;\r\n\r\n    const valMap: {[key: string]: number} = {};\r\n\r\n    this._options.forEach(({value}, index) => {\r\n      valMap[value] = index;\r\n    });\r\n\r\n    this._selectedIndexes = [];\r\n\r\n    val.forEach((v) =>{\r\n      if (valMap[v]) {\r\n        this._selectedIndexes.push(valMap[v]);\r\n      }\r\n    });\r\n  }\r\n  get value(): string[] {\r\n    return this._values;\r\n  }\r\n\r\n  _multiple = true;\r\n\r\n  private _onOptionClick(ev: MouseEvent) {\r\n    const composedPath = ev.composedPath();\r\n    const optEl = composedPath.find((et) => {\r\n      if ('matches' in et) {\r\n        return (et as HTMLElement).matches('li.option');\r\n      }\r\n\r\n      return false;\r\n    });\r\n\r\n    if (!optEl) {\r\n      return;\r\n    }\r\n\r\n    const index = Number((optEl as HTMLElement).dataset.index);\r\n\r\n    if (this._options[index]) {\r\n      this._options[index].selected = !this._options[index].selected;\r\n    }\r\n\r\n    this._selectedIndexes = [];\r\n    this._values = [];\r\n\r\n    this._options.forEach((op) => {\r\n      if (op.selected) {\r\n        this._selectedIndexes.push(op.index);\r\n        this._values.push(op.value);\r\n      }\r\n    });\r\n\r\n    this._dispatchChangeEvent();\r\n  }\r\n\r\n  private _onMultiAcceptClick(): void {\r\n    this._toggleDropdown(false);\r\n  }\r\n\r\n  private _onMultiDeselectAllClick(): void {\r\n    this._selectedIndexes = [];\r\n    this._values = [];\r\n    this._options = this._options.map((op) => ({...op, selected: false}));\r\n    this._dispatchChangeEvent();\r\n  }\r\n\r\n  private _onMultiSelectAllClick(): void {\r\n    this._selectedIndexes = [];\r\n    this._values = [];\r\n    this._options = this._options.map((op) => ({...op, selected: true}));\r\n    this._options.forEach((op, index) => {\r\n      this._selectedIndexes.push(index);\r\n      this._values.push(op.value);\r\n      this._dispatchChangeEvent();\r\n    });\r\n  }\r\n\r\n  private _renderLabel() {\r\n    switch (this._selectedIndexes.length) {\r\n      case 0:\r\n        return html`<span class=\"select-face-badge no-item\"\r\n          >No items selected</span\r\n        >`;\r\n      case 1:\r\n        return html`<span class=\"select-face-badge\">1 item selected</span>`;\r\n      default:\r\n        return html`<span class=\"select-face-badge\"\r\n          >${this._selectedIndexes.length} items selected</span\r\n        >`;\r\n    }\r\n  }\r\n\r\n  protected _renderSelectFace(): TemplateResult {\r\n    return html`\r\n      <div class=\"select-face multiselect\" @click=\"${this._onFaceClick}\">\r\n        ${this._renderLabel()} ${chevronDownIcon}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  protected _renderComboboxFace(): TemplateResult {\r\n    const inputVal =\r\n      this._selectedIndex > -1 ? this._options[this._selectedIndex].label : '';\r\n\r\n    return html`\r\n      <div class=\"combobox-face\">\r\n        ${this._renderLabel()}\r\n        <input\r\n          class=\"combobox-input\"\r\n          spellcheck=\"false\"\r\n          type=\"text\"\r\n          .value=\"${inputVal}\"\r\n          @focus=\"${this._onComboboxInputFocus}\"\r\n          @input=\"${this._onComboboxInputInput}\"\r\n        />\r\n        <button\r\n          class=\"combobox-button\"\r\n          type=\"button\"\r\n          @click=\"${this._onComboboxButtonClick}\"\r\n          @keydown=\"${this._onComboboxButtonKeyDown}\"\r\n        >\r\n          ${chevronDownIcon}\r\n        </button>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  protected _renderOptions(): TemplateResult {\r\n    const list = this.combobox ? this._filteredOptions : this._options;\r\n\r\n    return html`\r\n      <ul\r\n        class=\"options\"\r\n        @click=\"${this._onOptionClick}\"\r\n        @mouseover=\"${this._onOptionMouseOver}\"\r\n      >\r\n        ${repeat(\r\n          list,\r\n          (op) => op.index,\r\n          (op, index) => {\r\n            const selected = this._selectedIndexes.includes(op.index);\r\n            const optionClasses = classMap({\r\n              active: index === this._activeIndex,\r\n              option: true,\r\n              selected,\r\n            });\r\n            const checkboxClasses = classMap({\r\n              'checkbox-icon': true,\r\n              checked: selected,\r\n            });\r\n\r\n            return html`\r\n              <li\r\n                class=\"${optionClasses}\"\r\n                data-index=\"${op.index}\"\r\n                data-filtered-index=\"${index}\"\r\n              >\r\n                <span class=\"${checkboxClasses}\"></span>\r\n                <span class=\"option-label\">${op.label}</span>\r\n              </li>\r\n            `;\r\n          }\r\n        )}\r\n      </ul>\r\n    `;\r\n  }\r\n\r\n  protected _renderDropdownControls(): TemplateResult {\r\n    return html`\r\n      <div class=\"dropdown-controls\">\r\n        <button\r\n          type=\"button\"\r\n          @click=\"${this._onMultiSelectAllClick}\"\r\n          title=\"Select all\"\r\n          class=\"action-icon\"\r\n        >\r\n          <vscode-icon name=\"checklist\"></vscode-icon>\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          @click=\"${this._onMultiDeselectAllClick}\"\r\n          title=\"Deselect all\"\r\n          class=\"action-icon\"\r\n        >\r\n          <vscode-icon name=\"clear-all\"></vscode-icon>\r\n        </button>\r\n        <vscode-button @click=\"${this._onMultiAcceptClick}\">OK</vscode-button>\r\n      </div>\r\n    `;\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'vscode-multi-select': VscodeMultiSelect;\r\n  }\r\n}\r\n"]}